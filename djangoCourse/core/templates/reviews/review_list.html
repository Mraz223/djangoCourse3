{% extends 'base.html' %}

{% block title %}Отзывы{% endblock %}

{% block content %}
<style>
    .reviews-wrapper {
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 0;
    }

    .reviews-title {
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 24px;
    }

    .reviews-block-title {
        font-size: 22px;
        font-weight: 600;
        margin-bottom: 12px;
    }

    .review-form {
        margin-bottom: 32px;
        padding: 16px 20px;
        border-radius: 8px;
        background: #f5f5f5;
        border: 1px solid #ddd;
    }

    .review-form textarea {
        width: 100%;
        resize: vertical;
        padding: 10px 12px;
        border-radius: 6px;
        border: 1px solid #ccc;
        font-size: 14px;
        box-sizing: border-box;
    }

    .review-form button {
        margin-top: 12px;
        padding: 8px 18px;
        border-radius: 6px;
        border: 1px solid #000;
        background: #fff;
        cursor: pointer;
        font-weight: 500;
    }

    .review-form button:hover {
        background: #000;
        color: #fff;
    }

    .reviews-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .review-item {
        padding: 14px 18px;
        border-radius: 10px;
        border: 1px solid #e0e0e0;
        background: #ffffff;
        box-shadow: 0 1px 3px rgba(0,0,0,0.06);
        margin-bottom: 12px;
    }

    .review-header {
        font-size: 14px;
        color: #555;
        margin-bottom: 4px;
    }

    .review-author {
        font-weight: 600;
        margin-right: 6px;
    }

    .review-date {
        font-size: 12px;
        color: #888;
    }

    .review-text {
        font-size: 14px;
        line-height: 1.4;
        white-space: pre-wrap;
    }

    .reviews-empty {
        color: #777;
        font-size: 14px;
    }
</style>

<div class="reviews-wrapper">
    <h1 class="reviews-title">Отзывы пользователей</h1>

    {% if user.is_authenticated %}
        <h2 class="reviews-block-title">Оставить отзыв</h2>
        <form method="post" class="review-form">
            {% csrf_token %}
            {{ form.non_field_errors }}
            <label for="{{ form.text.id_for_label }}">{{ form.text.label }}</label>
            {{ form.text }}
            {{ form.text.errors }}
            <button type="submit">Отправить отзыв</button>
        </form>
    {% else %}
        <p>Чтобы оставить отзыв, <a href="{% url 'login' %}">войдите</a> или <a href="{% url 'register' %}">зарегистрируйтесь</a>.</p>
    {% endif %}

    <h2 class="reviews-block-title">Все отзывы</h2>

    {% if reviews %}
        <ul class="reviews-list">
            {% for review in reviews %}
                <li class="review-item">
                    <div class="d-flex align-items-center mb-2">
                        <strong style="color: #0d6efd;">{{ review.user.username }}</strong>
                        <span style="color: #555; margin-left: 8px; font-size: 0.9rem;">
                            {{ review.created_at|date:"d.m.Y H:i" }}
                        </span>
                    </div>
                    <div class="review-text">
                        {{ review.text|linebreaksbr }}
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="reviews-empty">Пока нет ни одного отзыва.</p>
    {% endif %}
</div>
{% endblock %}
